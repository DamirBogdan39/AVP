library(readxl)
library(ggplot2)

#Ucitavanje podataka
data <- read_excel("data/data.xlsx")
View(data)

#Selekcija potrebnih kolona
data <- subset(data, select = c(GODINA, ID, BROJ_LAB_PROTOKOLA, POL,
                                GODINA_ROÐENJA, MESTO_PACIJENTA, 
                                USTANOVA_POSILJALAC_UZORKA, TRAJANJE_VAKCINACIJE,
                                RAZLIKA_ZAVRŠETKA_I_BUSTERA, 
                                RAZLIKA_PRIJEMA_I_UZORKOVANJA, 
                                RAZLIKA_PRIJEMA_I_POCETKA,
                                RAZLIKA_UZORKOVANJA_I_POCETKA,
                                UKUPNO_DANA_OD_VADJENJA_KRVI,
                                NAPOMENA,REZULTAT_ANALIZE,USPESNO_IMUNIZOVAN, 
                                DAT_SERUM,BROJ_JEDINICA,SERIJA_SERUMA,
                                LOT_VAKCINE,LOKACIJA_OZLEDA,BROJ_OZLEDA,
                                ŽIVOTINJA))

#Uklanjanje redova sa nedostajucim podacima na zavisnim varijablama

library(tidyr)

paste("Broj nedostajucih u varijabli REZULTAT_ANALIZE:",
      sum(is.na(data$REZULTAT_ANALIZE)))

#Uklanjanje reda sa nedostajucim podatkom u REZULTAT_ANALIZE varijabli
data <- data %>% drop_na(REZULTAT_ANALIZE)

paste("Broj nedostajucih u varijabli REZULTAT_ANALIZE:", 
      sum(is.na(data$REZULTAT_ANALIZE)))

paste("Broj nedostajucih u varijabli USPESNO_IMUNIZOVAN:",
      sum(is.na(data$USPESNO_IMUNIZOVAN)))
